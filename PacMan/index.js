var canvas = document.getElementById("animacion") //Obtenemos el elemento canvas
var ctx = canvas.getContext('2d')                 //Obtenemos el contexto del canvas

var img = new Image()   //Creamos un objeto imagen
img.src = "sprites.png" //Le asignamos la ruta de la imagen

/*************************** PacMan *****************/

var x = 0                  //Posición en x de pacMan
var y = 0                  //Posición en y de pacMan
var indice = 0             //Indice para la animación de pacMan
var avance_pacMan_x = 0    //avance de pacMan en x
var avance_pacMan_y = 0    //avance de pacMan en y
var pasos = 20              //Cantidad de pasos que dara pacMan

/************* Matrices de animación de pacMan **************/
let pacmanR = //l -> Right
    [
        [852,5,33,33,33,33],    //Derecha
        [852,55,33,33,33,33],   //Derecha
        [852,105,33,33,33,33],  //Derecha
    ]
let pacmanL = //l -> Left
    [
        [852,305,33,33,33,33],  //izquierda
        [852,355,33,33,33,33],  //izquierda
        [852,405,33,33,33,33]   //izquierda
    ]
let pacmanU = //U -> Up
    [
        [852,454,33,33,33,33],  //izquierda
        [852,507,33,33,33,33],  //izquierda
        [852,564,33,33,33,33]   //izquierda
    ]    
let pacmanD = //D -> Down
    [
        [852,155,33,33,33,33],  //izquierda
        [852,205,33,33,33,33],  //izquierda
        [852,255,33,33,33,33]   //izquierda
    ]
/**********************************************************************/    

document.addEventListener("keydown",detectarTecla) //keydown -> presionar tecla

function detectarTecla(e) {
    if(e.keyCode == 39) { //Right
        avance_pacMan_x = 1 * pasos;
        avance_pacMan_y = 0
    }
    if(e.keyCode == 37) { //Left
        avance_pacMan_x = -1 * pasos;
        avance_pacMan_y = 0
    }
    if(e.keyCode == 38) { //up
        avance_pacMan_y = -1 * pasos;
        avance_pacMan_x = 0
    }
    if(e.keyCode == 40) { //down
        avance_pacMan_y = 1 * pasos;
        avance_pacMan_x = 0
    }
}

function dibujaPacman() {
    if(x == 0 && y == 0){
        //inicializaPacMan()
        x = x1
        y = y1
        ctx.clearRect(x,y,33,33)
        ctx.drawImage(img,pacmanL[indice][0],pacmanL[indice][1],pacmanL[indice][2],pacmanL[indice][3],x,y,pacmanL[indice][4],pacmanL[indice][5])
        indice = (indice + 1) % 3
        avance_pacMan_x = -1 * pasos
        avance_pacMan_y = 0
    }

    if(avance_pacMan_x == 1 * pasos) {
        ctx.clearRect(x,y,33,33)
        ctx.drawImage(img,pacmanR[indice][0],pacmanR[indice][1],pacmanR[indice][2],pacmanR[indice][3],x,y,pacmanR[indice][4],pacmanR[indice][5])
        indice = (indice + 1) % 3
    } 

    if(avance_pacMan_x == -1 * pasos) {
        ctx.clearRect(x,y,33,33)
        ctx.drawImage(img,pacmanL[indice][0],pacmanL[indice][1],pacmanL[indice][2],pacmanL[indice][3],x,y,pacmanL[indice][4],pacmanL[indice][5])
        indice = (indice + 1) % 3
    }

    if(avance_pacMan_y == -1 * pasos){
        ctx.clearRect(x,y,33,33)
        ctx.drawImage(img,pacmanU[indice][0],pacmanU[indice][1],pacmanU[indice][2],pacmanU[indice][3],x,y,pacmanU[indice][4],pacmanU[indice][5])
        indice = (indice + 1) % 3
    } 

    if(avance_pacMan_y == 1 * pasos){
        ctx.clearRect(x,y,33,33)
        ctx.drawImage(img,pacmanD[indice][0],pacmanD[indice][1],pacmanD[indice][2],pacmanD[indice][3],x,y,pacmanD[indice][4],pacmanD[indice][5])
        indice = (indice + 1) % 3
    }

    console.log(indice)
}

/*************************** Escenario (Boundary) -> borde, limite *****************/

var bWidth = 40  //El ancho de cada cuadro
var bHeight = 40  //El alto de cada cuadro

var boundaryPositionX = 0 //La posición en x de cada cuadro
var boundaryPositionY = 0 //La posición en y de cada cuadro

var x1  //Seran las posiciones en donde inicializaremos a pacMan
var y1  //Seran las posiciones en donde inicializaremos a pacMan
var cx = -1//seran las coordenadas de la esquina superior izquierda del cuadro
var cy = -1//seran las coordenadas de la esquina superior izquierda del cuadro

let map     = [
    ['-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-'],
    ['-', ' ', ' ', ' ', ' ', ' ', ' ', '-', ' ', ' ', ' ', ' ', ' ', ' ', '-'],
    ['-', ' ', '-', ' ', '-', '-', ' ', '-', ' ', '-', '-', ' ', '-', ' ', '-'],
    ['-', ' ', ' ', ' ', ' ', ' ', ' ', '-', ' ', ' ', ' ', ' ', ' ', ' ', '-'],
    ['-', ' ', '-', '-', ' ', ' ', ' ', ' ', ' ', ' ', ' ', '-', '-', ' ', '-'],
    ['-', ' ', ' ', ' ', ' ', '-', '-', ' ', '-', '-', ' ', ' ', ' ', ' ', '-'],
    ['-', ' ', '-', '-', ' ', '-', ' ', ' ', ' ', '-', ' ', '-', '-', ' ', '-'],
    ['-', ' ', ' ', ' ', ' ', '-', ' ', ' ', ' ', '-', ' ', ' ', ' ', ' ', '-'],
    ['-', ' ', '-', '-', ' ', '-', '-', '-', '-', '-', ' ', '-', '-', ' ', '-'],
    ['-', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', '-'],
    ['-', ' ', '-', ' ', '-', '-', '-', '-', '-', '-', '-', ' ', '-', ' ', '-'],
    ['-', ' ', '-', ' ', ' ', ' ', 'p', '-', ' ', ' ', ' ', ' ', '-', ' ', '-'],
    ['-', ' ', '-', ' ', '-', '-', ' ', '-', ' ', '-', '-', ' ', '-', ' ', '-'],
    ['-', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', '-'],
    ['-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-']
]

let map2 = [
    ['-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-'],
    ['-', ' ', ' ', ' ', '-', ' ', '-', ' ', '-', ' ', '-', ' ', ' ', ' ', '-'],
    ['-', ' ', '-', ' ', '-', ' ', '-', ' ', '-', ' ', '-', ' ', '-', ' ', '-'],
    ['-', ' ', '-', ' ', '-', ' ', '-', ' ', '-', ' ', '-', ' ', '-', ' ', '-'],
    ['-', ' ', '-', ' ', '-', ' ', '-', ' ', '-', ' ', '-', ' ', '-', ' ', '-'],
    ['-', ' ', '-', ' ', '-', '-', '-', ' ', '-', '-', '-', ' ', '-', ' ', '-'],
    ['-', ' ', '-', ' ', '-', ' ', ' ', ' ', ' ', '-', ' ', ' ', '-', ' ', '-'],
    ['-', ' ', '-', ' ', '-', ' ', '-', ' ', '-', '-', '-', ' ', '-', ' ', '-'],
    ['-', ' ', '-', ' ', '-', '-', '-', '-', '-', '-', ' ', ' ', '-', ' ', '-'],
    ['-', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', '-', ' ', '-'],
    ['-', '-', '-', '-', '-', '-', ' ', '-', '-', '-', '-', '-', '-', ' ', '-'],
    ['-', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', '-'],
    ['-', ' ', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-'],
    ['-', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', '-'],
    ['-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-']
]

let map3 = [
    ['-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-'],
    ['-', ' ', '-', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', '-'],
    ['-', ' ', '-', ' ', '-', ' ', ' ', ' ', ' ', ' ', '-', '-', '-', ' ', '-'],
    ['-', ' ', '-', ' ', '-', ' ', ' ', ' ', ' ', ' ', '-', ' ', '-', ' ', '-'],
    ['-', ' ', '-', ' ', '-', ' ', ' ', ' ', ' ', ' ', '-', '-', '-', ' ', '-'],
    ['-', ' ', '-', ' ', '-', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', '-'],
    ['-', ' ', '-', ' ', '-', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', '-'],
    ['-', ' ', '-', ' ', '-', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', '-'],
    ['-', ' ', '-', ' ', '-', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', '-'],
    ['-', ' ', '-', ' ', '-', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', '-'],
    ['-', ' ', '-', ' ', '-', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', '-'],
    ['-', ' ', '-', ' ', '-', ' ', ' ', ' ', ' ', '-', ' ', ' ', ' ', ' ', '-'],
    ['-', ' ', '-', ' ', '-', ' ', '-', '-', '-', '-', ' ', ' ', ' ', ' ', '-'],
    ['-', ' ', ' ', ' ', '-', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', '-'],
    ['-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-']
]

let map4 = [
    ['-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-'],
    ['-', ' ', '-', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', '-'],
    ['-', ' ', '-', ' ', '-', ' ', ' ', ' ', ' ', ' ', '-', '-', '-', ' ', '-'],
    ['-', ' ', '-', ' ', '-', ' ', ' ', ' ', ' ', ' ', '-', ' ', '-', ' ', '-'],
    ['-', ' ', '-', ' ', '-', ' ', ' ', ' ', ' ', ' ', '-', '-', '-', ' ', '-'],
    ['-', ' ', '-', ' ', '-', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', '-'],
    ['-', ' ', '-', ' ', '-', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', '-'],
    ['-', ' ', '-', ' ', '-', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', '-'],
    ['-', ' ', '-', ' ', '-', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', '-'],
    ['-', ' ', '-', ' ', '-', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', '-'],
    ['-', ' ', '-', ' ', '-', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', '-'],
    ['-', ' ', '-', ' ', '-', ' ', ' ', ' ', ' ', '-', ' ', ' ', ' ', ' ', '-'],
    ['-', ' ', '-', ' ', '-', ' ', '-', '-', '-', '-', ' ', ' ', ' ', ' ', '-'],
    ['-', ' ', ' ', ' ', '-', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', '-'],
    ['-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-']
]

let map5 = [
    ['-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-'],
    ['-', ' ', '-', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', '-'],
    ['-', ' ', '-', ' ', '-', ' ', ' ', ' ', ' ', ' ', '-', '-', '-', ' ', '-'],
    ['-', ' ', '-', ' ', '-', ' ', ' ', ' ', ' ', ' ', '-', ' ', '-', ' ', '-'],
    ['-', ' ', '-', ' ', '-', ' ', ' ', ' ', ' ', ' ', '-', '-', '-', ' ', '-'],
    ['-', ' ', '-', ' ', '-', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', '-'],
    ['-', ' ', '-', ' ', '-', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', '-'],
    ['-', ' ', '-', ' ', '-', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', '-'],
    ['-', ' ', '-', ' ', '-', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', '-'],
    ['-', ' ', '-', ' ', '-', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', '-'],
    ['-', ' ', '-', ' ', '-', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', '-'],
    ['-', ' ', '-', ' ', '-', ' ', ' ', ' ', ' ', '-', ' ', ' ', ' ', ' ', '-'],
    ['-', ' ', '-', ' ', '-', ' ', '-', '-', '-', '-', ' ', ' ', ' ', ' ', '-'],
    ['-', ' ', ' ', ' ', '-', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', '-'],
    ['-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-']
]

let map6 = [
    ['-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-'],
    ['-', ' ', '-', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', '-'],
    ['-', ' ', '-', ' ', '-', ' ', ' ', ' ', ' ', ' ', '-', '-', '-', ' ', '-'],
    ['-', ' ', '-', ' ', '-', ' ', ' ', ' ', ' ', ' ', '-', ' ', '-', ' ', '-'],
    ['-', ' ', '-', ' ', '-', ' ', ' ', ' ', ' ', ' ', '-', '-', '-', ' ', '-'],
    ['-', ' ', '-', ' ', '-', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', '-'],
    ['-', ' ', '-', ' ', '-', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', '-'],
    ['-', ' ', '-', ' ', '-', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', '-'],
    ['-', ' ', '-', ' ', '-', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', '-'],
    ['-', ' ', '-', ' ', '-', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', '-'],
    ['-', ' ', '-', ' ', '-', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', '-'],
    ['-', ' ', '-', ' ', '-', ' ', ' ', ' ', ' ', '-', ' ', ' ', ' ', ' ', '-'],
    ['-', ' ', '-', ' ', '-', ' ', '-', '-', '-', '-', ' ', ' ', ' ', ' ', '-'],
    ['-', ' ', ' ', ' ', '-', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', '-'],
    ['-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-']
]

let map7 = [
    ['-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-'],
    ['-', ' ', '-', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', '-'],
    ['-', ' ', '-', ' ', '-', ' ', ' ', ' ', ' ', ' ', '-', '-', '-', ' ', '-'],
    ['-', ' ', '-', ' ', '-', ' ', ' ', ' ', ' ', ' ', '-', ' ', '-', ' ', '-'],
    ['-', ' ', '-', ' ', '-', ' ', ' ', ' ', ' ', ' ', '-', '-', '-', ' ', '-'],
    ['-', ' ', '-', ' ', '-', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', '-'],
    ['-', ' ', '-', ' ', '-', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', '-'],
    ['-', ' ', '-', ' ', '-', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', '-'],
    ['-', ' ', '-', ' ', '-', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', '-'],
    ['-', ' ', '-', ' ', '-', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', '-'],
    ['-', ' ', '-', ' ', '-', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', '-'],
    ['-', ' ', '-', ' ', '-', ' ', ' ', ' ', ' ', '-', ' ', ' ', ' ', ' ', '-'],
    ['-', ' ', '-', ' ', '-', ' ', '-', '-', '-', '-', ' ', ' ', ' ', ' ', '-'],
    ['-', ' ', ' ', ' ', '-', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', '-'],
    ['-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-']
]

let map8 = [
    ['-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-'],
    ['-', ' ', '-', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', '-'],
    ['-', ' ', '-', ' ', '-', ' ', ' ', ' ', ' ', ' ', '-', '-', '-', ' ', '-'],
    ['-', ' ', '-', ' ', '-', ' ', ' ', ' ', ' ', ' ', '-', ' ', '-', ' ', '-'],
    ['-', ' ', '-', ' ', '-', ' ', ' ', ' ', ' ', ' ', '-', '-', '-', ' ', '-'],
    ['-', ' ', '-', ' ', '-', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', '-'],
    ['-', ' ', '-', ' ', '-', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', '-'],
    ['-', ' ', '-', ' ', '-', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', '-'],
    ['-', ' ', '-', ' ', '-', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', '-'],
    ['-', ' ', '-', ' ', '-', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', '-'],
    ['-', ' ', '-', ' ', '-', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', '-'],
    ['-', ' ', '-', ' ', '-', ' ', ' ', ' ', ' ', '-', ' ', ' ', ' ', ' ', '-'],
    ['-', ' ', '-', ' ', '-', ' ', '-', '-', '-', '-', ' ', ' ', ' ', ' ', '-'],
    ['-', ' ', ' ', ' ', '-', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', '-'],
    ['-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-']
]

let map9 = [
    ['-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-'],
    ['-', ' ', '-', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', '-'],
    ['-', ' ', '-', ' ', '-', ' ', ' ', ' ', ' ', ' ', '-', '-', '-', ' ', '-'],
    ['-', ' ', '-', ' ', '-', ' ', ' ', ' ', ' ', ' ', '-', ' ', '-', ' ', '-'],
    ['-', ' ', '-', ' ', '-', ' ', ' ', ' ', ' ', ' ', '-', '-', '-', ' ', '-'],
    ['-', ' ', '-', ' ', '-', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', '-'],
    ['-', ' ', '-', ' ', '-', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', '-'],
    ['-', ' ', '-', ' ', '-', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', '-'],
    ['-', ' ', '-', ' ', '-', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', '-'],
    ['-', ' ', '-', ' ', '-', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', '-'],
    ['-', ' ', '-', ' ', '-', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', '-'],
    ['-', ' ', '-', ' ', '-', ' ', ' ', ' ', ' ', '-', ' ', ' ', ' ', ' ', '-'],
    ['-', ' ', '-', ' ', '-', ' ', '-', '-', '-', '-', ' ', ' ', ' ', ' ', '-'],
    ['-', ' ', ' ', ' ', '-', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', '-'],
    ['-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-']
]

let map10 = [
    ['-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-'],
    ['-', ' ', '-', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', '-'],
    ['-', ' ', '-', ' ', '-', ' ', ' ', ' ', ' ', ' ', '-', '-', '-', ' ', '-'],
    ['-', ' ', '-', ' ', '-', ' ', ' ', ' ', ' ', ' ', '-', ' ', '-', ' ', '-'],
    ['-', ' ', '-', ' ', '-', ' ', ' ', ' ', ' ', ' ', '-', '-', '-', ' ', '-'],
    ['-', ' ', '-', ' ', '-', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', '-'],
    ['-', ' ', '-', ' ', '-', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', '-'],
    ['-', ' ', '-', ' ', '-', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', '-'],
    ['-', ' ', '-', ' ', '-', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', '-'],
    ['-', ' ', '-', ' ', '-', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', '-'],
    ['-', ' ', '-', ' ', '-', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', '-'],
    ['-', ' ', '-', ' ', '-', ' ', ' ', ' ', ' ', '-', ' ', ' ', ' ', ' ', '-'],
    ['-', ' ', '-', ' ', '-', ' ', '-', '-', '-', '-', ' ', ' ', ' ', ' ', '-'],
    ['-', ' ', ' ', ' ', '-', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', '-'],
    ['-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-']
]

function drawBoundary(map){
    map.forEach((row, i) => {
        row.forEach((symbol, j) => {
            boundaryPositionX = bWidth * j;
            boundaryPositionY = bHeight * i;
            if(i == 11 && j == 6){
                x1 = boundaryPositionX
                y1 = boundaryPositionY
            }
            switch (symbol) {
                case '-':
                    ctx.fillStyle = 'blue';
                    ctx.fillRect(boundaryPositionX, boundaryPositionY, bWidth, bHeight)
                    cx = boundaryPositionX
                    cy = boundaryPositionY
                    break;
            }
        });
    });
}

/*************************** Colisión *****************/
let wallX
let wallY
let nextX
let nextY

function detectarColision(){
    for(let i = 0; i < map.length; i++) {
        for(let j = 0; j < map[i].length; j++) {
            if(map[i][j] === '-') {
                wallX = j * bWidth;
                wallY = i * bHeight;
                nextX = x + avance_pacMan_x;
                nextY = y + avance_pacMan_y;
                if(nextX < wallX + bWidth && nextX + 33 > wallX && nextY < wallY + bHeight && nextY + 33 > wallY) {
                    avance_pacMan_x = 0;
                    avance_pacMan_y = 0;            
                }
                if(avance_pacMan_x == 0 && avance_pacMan_y == 0) {
                    ctx.clearRect(x,y,33,33)
                    ctx.drawImage(img,pacmanL[indice][0],pacmanL[indice][1],pacmanL[indice][2],pacmanL[indice][3],x,y,pacmanL[indice][4],pacmanL[indice][5])
                    indice = (indice + 1) % 3
                    //dibujaPacman()
                }
            }
            if(map[i][j] === ' '){
                wallX = j * bWidth;
                wallY = i * bHeight;
                nextX = x + avance_pacMan_x;
                nextY = y + avance_pacMan_y;
                if(nextX < wallX + bWidth && nextX + 33 > wallX && nextY < wallY + bHeight && nextY + 33 > wallY) {
                    map[i][j] = 'p'
                }
                //map[i][j] = 'p'
            }
        }
    }
}

/*************************** Puntos *****************/
let pointPositionX
let pointPositionY

function drawPoints(map) {
    for(let i = 0; i < map.length; i++) {
        for(let j = 0; j < map[i].length; j++) {
            // Si la celda está dentro de la "caja de fantasmas", continuar con la siguiente celda
            if(i >= 5 && i <= 9 && j >= 5 && j <= 9) {
                continue;
            }

            // Si la celda es un pasillo, dibujar un punto
            if(map[i][j] === ' ') {
                pointPositionX = bWidth * j + bWidth / 2;
                pointPositionY = bHeight * i + bHeight / 2;
                ctx.fillStyle = 'white';
                ctx.beginPath();
                ctx.arc(pointPositionX, pointPositionY, bWidth / 8, 0, Math.PI * 2, true); // Radio del círculo reducido a la mitad
                ctx.fill();
            }
        }
    }
} 

/*************************** SCORE**********************/
var score = 0

function drawScore() {
    if(pointPositionX == x && pointPositionY == y){
        score += 1
        ctx.fillStyle = 'white';
        ctx.arc(pointPositionX, pointPositionY, bWidth / 8, 0, Math.PI * 2, true); // Radio del círculo reducido a la mitad
        ctx.fill();
    }
}
/*************************** ANIMACIÓN *****************/

function draw() {
    ctx.clearRect(0,0,canvas.width,canvas.height)
    drawBoundary(map)
    drawPoints(map)
    dibujaPacman()
    detectarColision()
    drawScore()

    if(avance_pacMan_x == 1*pasos){
        x += avance_pacMan_x
    }
    if(avance_pacMan_x == -1 * pasos){
        x += avance_pacMan_x
    }
    if(avance_pacMan_y == -1 * pasos){
        y += avance_pacMan_y
    }
    if(avance_pacMan_y == 1 * pasos){
        y += avance_pacMan_y
    }
}

img.onload = function() { //
    setInterval(draw,100)
}